\documentclass{article}

\usepackage{afterpage}
\usepackage{fontspec}
\usepackage{geometry}
\usepackage{hyperref}
\usepackage{lscape}
\usepackage{pgfgantt}
\usepackage{siunitx}
\usepackage{titling}

\newcommand*{\subtitle}[1]{\gdef\thesubtitle{#1}}

\title{CRAPS Kernel}
\subtitle{Specifications}
\author{
       Maxime Arthaud
  \and Korantin Auguste
  \and Martin Carton
  \and Ã‰tienne Lebrun
  \and Pierre-Louis Michel
}

\begin{document}
  \include{titlepage}
  \newpage
    \section{V1 Specifications}
      The first version consists of the most basic OS functionalities.

      \subsection{Improvement of the Processor}
        \begin{enumerate}
          \item The processor should have access to at least \SI{32}{kB} of RAM.
            The RAM should be accessed in a fast way, but the loss of a few
            (less than 10) cycles is acceptable.
          \item The processor should handle several interruptions sources, with
            a priority system. An interruption handler can only be interrupted
            by an interruption of a strictly higher priority.
          \item Several registers should be added.
        \end{enumerate}

      \subsection{Compiler}
        To write the OS in reasonable time, we need to be able to compile a
        higher level language to CRAPS assembly. For that purpose, we chose to
        reuse the compiler we wrote last year.
        \begin{enumerate}
          \item The compiler input should be a subset of \textit{C89} (see
            appendix~\ref{app:C89} for details).
          \item The compiler should generate valid CRAPS assembly.
        \end{enumerate}

      \subsection{Development of the OS}
        \begin{enumerate}
          \item The OS should have a scheduler. There are no real-time
          constraint (but it should switch regularly, at least 10 times per
          second). It should support at least 10 hard-coded tasks.
          \item The OS should provide a basic library available to any program:
            \begin{itemize}
              \item a \verb+malloc+ to allocate dynamic memory;
              \item functions to write on the LEDs and seven-segment display,
                and read the switches;
              \item division and modulus operations.
             \end{itemize}
        \end{enumerate}

    \section{V2 Specifications}
      The second version adds distant communications, and updated tools.

      \subsection{Improvement of the Processor}
        \begin{enumerate}
          \item The processor should be connected to a serial port, to allow
            communication with other devices (like a computer). It can use the
            \textit{RS-232} port on the FPGA.
        \end{enumerate}

      \subsection{Compiler}
        \begin{enumerate}
          \item Enlarge the subset of \textit{C89}
          \item The compiler should generate valid CRAPS assembly.
          \item The assembly generated should be more optimized.
        \end{enumerate}

      \subsection{Development of the OS}
        \begin{enumerate}
          \item The OS should have a task communicating with the user through
            the \textit{RS-232}, in the form of a very simple shell.
          \item Extension to the OS library: an API to read/write to the serial
            port.
        \end{enumerate}
      \subsection{tools}
        \begin{enumerate}
          \item The monitor should be available in Linux.
          \item The monitor should display all the ram.
          \item The Craps assembler should be available without a FPGA.
          \item Adapt the tools to provide a good environment to be used by the
            students.

    \section{Further Development}
      If we have enough time, it would be interesting to access the flash memory
      present on the board. This implies the development of a SHDL/VHDL module
      and the OS code to use it. With this improvements, we could:
      \begin{itemize}
        \item write and read memory from the shell;
        \item implement a basic file system.
      \end{itemize}
      Ideally, we could write a tutorial for the students, explaining the steps
      to realise their own OS.

  \newpage

  \begin{appendix}
    \section{Description of the C subset}\label{app:C89}
      The C subset available at the beginning of the project includes
      (non-exhaustive list):
      \begin{itemize}
        \item \textit{while} loop
        \item \textit{if} loop (no \textit{else if})
        \item 32-bits integer arithmetic (without division, modulo and only
          16-bits multiplication)
        \item functions
        \item an \text{x86} back-end
      \end{itemize}

      \noindent The \textit{V1} should add:
      \begin{itemize}
        \item a \text{CRAPS} back-end
        \item global variables
        \item exported functions
        \item \textit{for} loop
        \item missing operators
      \end{itemize}

      \noindent The following elements are planned for the \textit{V2}:
      \begin{itemize}
        \item dynamic memory
        \item arrays
        \item structures
        \item the \verb+&+ (address) operator
      \end{itemize}
      We will add more functionalities if they prove to be needed to write the
      OS. 
  \end{appendix}

\end{document}
